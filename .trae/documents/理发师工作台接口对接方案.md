# 对接理发师工作台后端接口计划

根据您提供的接口文档和页面需求，我们将进行以下修改：

## 1. 接口定义更新 (`api/haircut/haircut.js`)

在 `api/haircut/haircut.js` 中新增两个 API 方法：

*   `getBarberDashboardStats()`:
    *   URL: `/api/haircut/barber/dashboard/stats`
    *   Method: `GET`
    *   用途: 获取看板统计数据。
*   `getBarberDashboardList(query)`:
    *   URL: `/api/haircut/barber/dashboard/list`
    *   Method: `GET`
    *   Params: `query` (用于分页参数 `pageNum`, `pageSize`)
    *   用途: 获取工作台任务列表。

## 2. 页面逻辑重构 (`pages/barber/dashboard.vue`)

### A. 状态与数据结构
*   更新 `stats` 对象，字段映射为：
    *   `avgRating`: 对应接口 `data.avgRating` (综合评分)
    *   `returningCount`: 对应接口 `data.todayPending` (今日待服务)
    *   `totalServed`: 对应接口 `data.totalServed` (累计服务)
*   引入分页参数 `queryParams` (`pageNum`, `pageSize`)。

### B. 数据加载逻辑 (`loadData`)
*   **移除 Mock 数据**：删除 `setTimeout` 和 `DB` 引用。
*   **并行请求**：同时调用 `getBarberDashboardStats` 和 `getBarberDashboardList`。
*   **列表渲染**：
    *   将接口返回的 `status` 字段映射为前端样式：
        *   `'0'` -> `booked` (待服务, 绿色)
        *   `'1'` -> `pending_eval` (待评价, 橙色)
        *   `'2'` -> `completed` (已完成, 灰色)
    *   直接使用接口返回的 `userPhone`。

### C. 交互优化
*   支持下拉刷新 (`onPullDownRefresh`)。
*   支持触底加载更多 (`onReachBottom`)。

## 3. 实施步骤

1.  **修改 API 文件**：添加新接口。
2.  **修改 Vue 组件**：重构 `loadData` 方法，对接真实接口，移除 Mock 逻辑。
3.  **验证**：确保数据正确渲染，状态映射准确。