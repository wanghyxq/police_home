# 修复理发师访问个人中心权限问题

经检查，`permission.js` 中的 `isPolicePage` 判断逻辑将 `/pages/mine/` 开头的页面视为民警端核心页面，导致理发师访问 `/pages/mine/index` 时被拦截并重定向回工作台。

## 1. 问题分析

* **当前逻辑**:

  ```javascript
  function isPolicePage(url) {
    return url === '/pages/index' || url.startsWith('/pages/haircut/') || url.startsWith('/pages/mine/')
  }
  ```

* **拦截规则**: 如果 `isBarber` 为真 且 `isPolicePage(url)` 为真，则重定向。

* **冲突点**: `/pages/mine/index` 现在是理发师和民警共用的页面，不应被视为“民警独占页面”。

## 2. 解决方案

我们需要修改 `isPolicePage` 函数，将 `/pages/mine/` 从民警独占页面列表中移除，或者特例放行 `/pages/mine/index`。

建议将 `/pages/mine/index` 视为通用页面（Common Page），即理发师和民警均可访问。

## 3. 修改计划

1. **修改** **`permission.js`**:

   * 调整 `isPolicePage` 函数，移除对 `/pages/mine/` 的全量匹配。

   * 或者更精细地定义：`url.startsWith('/pages/mine/') && url !== '/pages/mine/index'` (如果 `mine` 下还有其他仅限民警的页面)。

   * 考虑到 `mine` 下的子页面（如修改密码、关于我们等）通常也是通用的，最简单的做法是直接允许理发师访问所有 `/pages/mine/` 页面。

2. **新逻辑**:

   ```javascript
   function isPolicePage(url) {
     // 移除 url.startsWith('/pages/mine/')
     return url === '/pages/index' || url.startsWith('/pages/haircut/')
   }
   ```

   *注意*：如果 `/pages/haircut/` 下有理发师也需要访问的页面（目前看似乎没有，理发师端都在 `/pages/barber/`），则需谨慎。目前理发师端逻辑是独立的。

3. **验证**:

   * 理发师登录 -> 点击“我的” -> 成功跳转 `/pages/mine/index`。

   * 民警登录 -> 点击“我的” -> 成功跳转 `/pages/mine/index`。

## 4. 实施步骤

1. **修改** **`permission.js`**: 更新 `isPolicePage` 定义。

