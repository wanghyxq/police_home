# 对接美发预约后端接口计划

根据提供的后端接口定义，我们将对前端代码进行如下调整，实现数据驱动的日期和时段渲染。

## 1. 接口层更新 (`api/haircut/haircut.js`)

我们将新增/更新以下 API 方法以匹配后端定义：

* **新增** **`getBarberCalendar(barberId)`**:

  * URL: `/api/haircut/barber/calendar` (注：已自动修正用户提供的 `barber` 拼写错误)

  * Method: `GET`

  * 用于获取可预约日期列表。

* **更新** **`getBarberSchedule`** **(或重命名为** **`getAppointmentSlots`)**:

  * URL: `/api/haircut/barber/slots`

  * Method: `GET`

  * Params: `barberId`, `date`

  * 用于获取指定日期的号源。

## 2. 业务逻辑层更新 (`pages/haircut/book.vue`)

### A. 移除前端计算逻辑

* 删除 `MAX_DAYS` 和 `WORK_DAYS` 常量配置。

* 删除 `initCalendar` 中基于本地日期的生成算法。

### B. 实现后端数据获取

* **日期加载**: `initCalendar` 方法将改为调用 `getBarberCalendar` 接口。

  * 成功获取数据后，将响应的 `data` 直接赋值给 `dateList`。

  * 利用后端返回的 `displayWeek` 和 `displayDate` 字段进行渲染。

  * **默认选中**: 数据加载完成后，自动选中列表中的第一个日期，并触发时段查询。

* **时段加载**: `fetchSlots` 方法将调用新的号源接口。

  * 直接使用返回的 `data` 渲染 `timeSlots`。

  * 无需再进行数据格式转换（后端返回格式已匹配前端需求）。

## 3. 实施步骤

1. **更新 API 文件**: 修改 `api/haircut/haircut.js`，添加新接口定义。
2. **重构 Vue 组件**: 修改 `book.vue`，移除旧逻辑，接入新 API。
3. **验证**: 确保日期列表正确显示后端返回的“明天”、“周X”等标签，且点击日期能正确加载对应的时段数据。

